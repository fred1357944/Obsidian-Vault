/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __publicField = (obj, key, value) => {
  __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);
  return value;
};

// src/main.ts
__export(exports, {
  default: () => SettingsSearch
});
var import_obsidian = __toModule(require("obsidian"));

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// src/main.ts
var SettingsSearch = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "settingsSearchEl", createDiv("settings-search-container vertical-tab-header-group"));
    __publicField(this, "settingsResultsContainerEl", createDiv("settings-search-results-container vertical-tab-content"));
    __publicField(this, "settingsNavItemContainer", this.settingsSearchEl.createDiv("vertical-tab-header-group-items").createDiv("vertical-tab-nav-item settings-search-input"));
    __publicField(this, "settingsResultsEl");
    __publicField(this, "search");
    __publicField(this, "locale");
    __publicField(this, "resources", []);
    __publicField(this, "results", []);
    __publicField(this, "tabIndex", 0);
    __publicField(this, "pluginTabIndex", 0);
    __publicField(this, "settingCache", new Map());
    __publicField(this, "searchAppended", false);
    __publicField(this, "activeIndex", -1);
    __publicField(this, "activeSetting");
    __publicField(this, "scope", new import_obsidian.Scope(this.app.scope));
    __publicField(this, "mobileContainers", []);
  }
  async onload() {
    this.app.workspace.onLayoutReady(async () => {
      this.settingsResultsContainerEl.createEl("h3", {
        text: "Settings Search Results"
      });
      this.settingsResultsEl = this.settingsResultsContainerEl.createDiv("settings-search-results");
      this.buildScope();
      this.buildSearch();
      this.buildResources();
      this.buildPluginResources();
      this.patchSettings();
    });
  }
  buildResources() {
    const tab = this.app.setting.settingTabs[this.tabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.tabIndex++;
      setTimeout(() => this.buildResources());
    }
  }
  buildPluginResources() {
    const tab = this.app.setting.pluginTabs[this.pluginTabIndex];
    if (tab) {
      this.getTabResources(tab);
      this.pluginTabIndex++;
      setTimeout(() => this.buildPluginResources());
    }
  }
  get manifests() {
    return Object.values(this.app.plugins.manifests);
  }
  addResourceToCache(resource) {
    const setting = new import_obsidian.Setting(createDiv()).setName(resource.text).setDesc(createFragment((e) => e.createDiv().innerHTML = resource.desc ?? ""));
    if (resource.tab == "community-plugins") {
      let plugin = this.manifests.find((p) => p.name == resource.text);
      if (plugin && this.app.plugins.getPlugin(plugin.id)?._loaded && this.app.setting.pluginTabs.find((t) => t.id == plugin.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.id);
          });
        });
      }
    }
    if (resource.tab == "plugins") {
      const plugins = Object.values(this.app.internalPlugins.plugins);
      const plugin = plugins.find((p) => p._loaded && p.instance.name == resource.text);
      if (plugin && this.app.setting.pluginTabs.find((t) => t.id == plugin.instance.id)) {
        setting.addExtraButton((b) => {
          b.setTooltip(`Open ${resource.text} Settings`).onClick(() => {
            this.app.setting.openTabById(plugin.instance.id);
          });
        });
      }
    }
    setting.addExtraButton((b) => {
      b.setIcon("forward-arrow").onClick(() => {
        this.showResult(resource);
      });
    });
    this.settingCache.set(resource.text, setting);
  }
  getResourceFromCache(resource) {
    if (!this.settingCache.has(resource.text)) {
      this.addResourceToCache(resource);
    }
    return this.settingCache.get(resource.text);
  }
  removeResourcesFromCache(resources) {
    for (const resource of resources) {
      this.settingCache.delete(resource.text);
    }
  }
  async getTabResources(tab) {
    await tab.display();
    const settings = tab.containerEl.querySelectorAll(".setting-item:not(.setting-item-header)");
    for (const el of Array.from(settings)) {
      const text = el.querySelector(".setting-item-name")?.textContent;
      if (!text)
        continue;
      const desc = el.querySelector(".setting-item-description")?.innerHTML ?? "";
      const resource = {
        tab: tab.id,
        name: tab.name,
        text,
        desc
      };
      this.resources.push(resource);
      this.addResourceToCache(resource);
    }
    if (this.app.setting.activeTab?.id == tab.id)
      return;
    tab.containerEl.detach();
    tab.hide();
  }
  patchSettings() {
    const self = this;
    this.register(around(this.app.setting, {
      onOpen: function(next) {
        return function() {
          next.apply(this);
          if (!import_obsidian.Platform.isMobile)
            self.search.inputEl.focus();
          return next;
        };
      }
    }));
    this.register(around(this.app.setting, {
      addSettingTab: function(next) {
        return function(tab) {
          self.getTabResources(tab);
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      removeSettingTab: function(next) {
        return function(tab) {
          if (this.isPluginSettingTab(tab)) {
            const removing = self.resources.filter((t) => t.tab == tab.id);
            self.resources = self.resources.filter((t) => t.tab != tab.id);
            self.removeResourcesFromCache(removing);
          }
          return next.call(this, tab);
        };
      }
    }));
    this.register(around(this.app.setting, {
      openTab: function(next) {
        return function(tab) {
          self.searchAppended = false;
          self.app.keymap.popScope(self.scope);
          return next.call(this, tab);
        };
      },
      openTabById: function(next) {
        return function(tab) {
          self.searchAppended = false;
          self.app.keymap.popScope(self.scope);
          return next.call(this, tab);
        };
      },
      onClose: function(next) {
        return function() {
          if (import_obsidian.Platform.isMobile) {
            self.detach();
          }
          return next.call(this);
        };
      }
    }));
  }
  buildSearch() {
    const tempSetting = new import_obsidian.Setting(createDiv()).addSearch((s) => {
      this.search = s;
    });
    this.settingsNavItemContainer.append(tempSetting.controlEl);
    tempSetting.settingEl.detach();
    this.search.onChange((v) => {
      this.onChange(v);
    });
    this.search.setPlaceholder("Search settings...");
    this.app.setting.tabHeadersEl.prepend(this.settingsSearchEl);
  }
  buildScope() {
    this.scope.register([], "ArrowDown", () => {
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
      }
      this.activeIndex = ((this.activeIndex + 1) % this.results.length + this.results.length) % this.results.length;
      this.centerActiveSetting();
    });
    this.scope.register([], "ArrowUp", () => {
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
      }
      this.activeIndex = ((this.activeIndex - 1) % this.results.length + this.results.length) % this.results.length;
      this.centerActiveSetting();
    });
    this.scope.register([], "Enter", () => {
      if (this.activeSetting) {
        this.showResult(this.results[this.activeIndex]);
      }
    });
  }
  centerActiveSetting() {
    const result = this.results[this.activeIndex];
    this.activeSetting = this.getResourceFromCache(result);
    this.activeSetting.settingEl.addClass("active");
    this.activeSetting.settingEl.scrollIntoView({
      behavior: "auto",
      block: "nearest"
    });
  }
  detachFromMobile() {
    if (import_obsidian.Platform.isMobile) {
      this.settingsResultsContainerEl.detach();
      for (const header of this.mobileContainers) {
        this.app.setting.tabHeadersEl.append(header);
      }
      this.search.setValue("");
    }
  }
  detachFromDesktop() {
    if (import_obsidian.Platform.isDesktop) {
      this.app.setting.openTabById(this.app.setting.lastTabId);
    }
  }
  detach() {
    this.detachFromDesktop();
    this.detachFromMobile();
    this.searchAppended = false;
  }
  onChange(v) {
    if (!v) {
      this.detach();
      this.app.keymap.popScope(this.scope);
      return;
    }
    if (!this.searchAppended) {
      this.activeIndex = -1;
      this.app.keymap.popScope(this.scope);
      this.app.keymap.pushScope(this.scope);
      if (this.activeSetting) {
        this.activeSetting.settingEl.removeClass("active");
        this.activeSetting = null;
      }
      if (!import_obsidian.Platform.isMobile) {
        this.app.setting.activeTab.navEl.removeClass("is-active");
        this.app.setting.tabContentContainer.empty();
        this.app.setting.tabContentContainer.append(this.settingsResultsContainerEl);
      } else {
        const headers = this.app.setting.tabHeadersEl.querySelectorAll(".vertical-tab-header-group:not(.settings-search-container)");
        for (const header of Array.from(headers)) {
          this.mobileContainers.push(header);
          header.detach();
        }
        this.app.setting.tabHeadersEl.append(this.settingsResultsContainerEl);
      }
      this.searchAppended = true;
    }
    this.appendResults(this.performFuzzySearch(v));
  }
  getMatchText(text, result) {
    const matchElements = {};
    return createFragment((content) => {
      for (let i = 0; i < text.length; i++) {
        let match = result.matches.find((m) => m[0] === i);
        if (match) {
          const index = result.matches.indexOf(match);
          if (!matchElements[index]) {
            matchElements[index] = createSpan("suggestion-highlight");
          }
          let element = matchElements[index];
          content.appendChild(element);
          element.appendText(text.substring(match[0], match[1]));
          i += match[1] - match[0] - 1;
          continue;
        }
        content.appendText(text[i]);
      }
    });
  }
  appendResults(results) {
    this.settingsResultsEl.empty();
    if (results.length) {
      const headers = {};
      for (const resource of results) {
        if (!(resource.tab in headers)) {
          headers[resource.tab] = this.settingsResultsEl.createDiv();
          new import_obsidian.Setting(headers[resource.tab]).setHeading().setName(resource.name);
        }
        const setting = this.getResourceFromCache(resource);
        headers[resource.tab].append(setting.settingEl);
      }
    } else {
      this.settingsResultsEl.setText("No results found :(");
    }
  }
  showResult(result) {
    this.search.setValue("");
    const tab = this.app.setting.settingTabs.find((t) => t.id == result.tab) ?? this.app.setting.pluginTabs.find((t) => t.id == result.tab);
    if (!tab) {
      new import_obsidian.Notice("There was an issue opening the setting tab.");
      return;
    }
    this.app.setting.openTabById(tab.id);
    this.app.keymap.popScope(this.scope);
    setTimeout(() => this.detach());
    try {
      const names = tab.containerEl.querySelectorAll(".setting-item-name");
      const el = Array.from(names).find((n) => n.textContent == result.text);
      if (!el)
        return;
      const setting = el.closest(".setting-item");
      if (!setting)
        return;
      if (tab.id == "obsidian-style-settings") {
        let collapsed = setting.closest(".style-settings-container");
        let previous = collapsed?.previousElementSibling;
        while (previous != null && previous.hasClass("is-collapsed") && previous.hasClass("style-settings-heading")) {
          previous.removeClass("is-collapsed");
          collapsed = collapsed.parentElement?.closest(".style-settings-container");
          previous = collapsed?.previousElementSibling;
        }
      }
      let details = setting.closest("details");
      while (details) {
        details.setAttr("open", "open");
        details = details.parentElement?.closest("details");
      }
      setting.scrollIntoView(true);
      setting.addClass("is-flashing");
      this.registerInterval(window.setTimeout(() => setting.removeClass("is-flashing"), 3e3));
    } catch (e) {
      console.error(e);
    }
  }
  performFuzzySearch(input) {
    const results = [], hotkeys = [];
    for (const resource of this.resources) {
      let result = (0, import_obsidian.prepareSimpleSearch)(input)(resource.text) ?? (0, import_obsidian.prepareSimpleSearch)(input)(resource.desc);
      if (result) {
        if (resource.tab == "hotkeys") {
          hotkeys.push(resource);
        } else {
          results.push(resource);
        }
      }
    }
    this.results = [...results, ...hotkeys];
    return this.results;
  }
  onunload() {
    this.settingsSearchEl.detach();
    this.settingsResultsEl.detach();
    this.detach();
    if (this.searchAppended && import_obsidian.Platform.isDesktop)
      this.app.setting.openTabById(this.app.setting.lastTabId);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vR2l0SHViL1BlcnNvbmFsL29ic2lkaWFuLXNldHRpbmdzLXNlYXJjaC9zcmMvbWFpbi50cyIsICIuLi8uLi8uLi8uLi9HaXRIdWIvUGVyc29uYWwvb2JzaWRpYW4tc2V0dGluZ3Mtc2VhcmNoL25vZGVfbW9kdWxlcy9tb25rZXktYXJvdW5kL21qcy9pbmRleC5qcyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHtcclxuICAgIFBsdWdpbixcclxuICAgIFNlYXJjaENvbXBvbmVudCxcclxuICAgIFNldHRpbmcsXHJcbiAgICBTZWFyY2hSZXN1bHQsXHJcbiAgICBOb3RpY2UsXHJcbiAgICBwcmVwYXJlU2ltcGxlU2VhcmNoLFxyXG4gICAgU2V0dGluZ1RhYixcclxuICAgIFNjb3BlLFxyXG4gICAgUGxhdGZvcm1cclxufSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmltcG9ydCB7IGFyb3VuZCB9IGZyb20gXCJtb25rZXktYXJvdW5kXCI7XHJcblxyXG5kZWNsYXJlIG1vZHVsZSBcIm9ic2lkaWFuXCIge1xyXG4gICAgaW50ZXJmYWNlIEFwcCB7XHJcbiAgICAgICAgaW50ZXJuYWxQbHVnaW5zOiB7XHJcbiAgICAgICAgICAgIHBsdWdpbnM6IFJlY29yZDxcclxuICAgICAgICAgICAgICAgIHN0cmluZyxcclxuICAgICAgICAgICAgICAgIHsgX2xvYWRlZDogYm9vbGVhbjsgaW5zdGFuY2U6IHsgbmFtZTogc3RyaW5nOyBpZDogc3RyaW5nIH0gfVxyXG4gICAgICAgICAgICA+O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgcGx1Z2luczoge1xyXG4gICAgICAgICAgICBtYW5pZmVzdHM6IFJlY29yZDxzdHJpbmcsIFBsdWdpbk1hbmlmZXN0PjtcclxuICAgICAgICAgICAgcGx1Z2luczogUmVjb3JkPHN0cmluZywgUGx1Z2luPjtcclxuICAgICAgICAgICAgZ2V0UGx1Z2luKGlkOiBzdHJpbmcpOiBQbHVnaW47XHJcbiAgICAgICAgfTtcclxuICAgICAgICBzZXR0aW5nOiB7XHJcbiAgICAgICAgICAgIG9uT3BlbigpOiB2b2lkO1xyXG4gICAgICAgICAgICBvbkNsb3NlKCk6IHZvaWQ7XHJcblxyXG4gICAgICAgICAgICBvcGVuVGFiQnlJZChpZDogc3RyaW5nKTogdm9pZDtcclxuICAgICAgICAgICAgb3BlblRhYih0YWI6IFNldHRpbmdUYWIpOiB2b2lkO1xyXG5cclxuICAgICAgICAgICAgaXNQbHVnaW5TZXR0aW5nVGFiKHRhYjogU2V0dGluZ1RhYik6IGJvb2xlYW47XHJcbiAgICAgICAgICAgIGFkZFNldHRpbmdUYWIodGFiOiBTZXR0aW5nVGFiKTogdm9pZDtcclxuICAgICAgICAgICAgcmVtb3ZlU2V0dGluZ1RhYih0YWI6IFNldHRpbmdUYWIpOiB2b2lkO1xyXG5cclxuICAgICAgICAgICAgYWN0aXZlVGFiOiBTZXR0aW5nVGFiO1xyXG4gICAgICAgICAgICBsYXN0VGFiSWQ6IHN0cmluZztcclxuXHJcbiAgICAgICAgICAgIHBsdWdpblRhYnM6IFBsdWdpblNldHRpbmdUYWJbXTtcclxuICAgICAgICAgICAgc2V0dGluZ1RhYnM6IFNldHRpbmdUYWJbXTtcclxuXHJcbiAgICAgICAgICAgIHRhYkNvbnRlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgICAgICB0YWJIZWFkZXJzRWw6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICBpbnRlcmZhY2UgUGx1Z2luIHtcclxuICAgICAgICBfbG9hZGVkOiBib29sZWFuO1xyXG4gICAgfVxyXG4gICAgaW50ZXJmYWNlIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgICAgIG5hbWU6IHN0cmluZztcclxuICAgIH1cclxuICAgIGludGVyZmFjZSBTZXR0aW5nVGFiIHtcclxuICAgICAgICBpZDogc3RyaW5nO1xyXG4gICAgICAgIG5hbWU6IHN0cmluZztcclxuICAgICAgICBuYXZFbDogSFRNTEVsZW1lbnQ7XHJcbiAgICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBSZXNvdXJjZSB7XHJcbiAgICB0YWI6IHN0cmluZztcclxuICAgIHRleHQ6IHN0cmluZztcclxuICAgIGRlc2M6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxufVxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZXR0aW5nc1NlYXJjaCBleHRlbmRzIFBsdWdpbiB7XHJcbiAgICBzZXR0aW5nc1NlYXJjaEVsOiBIVE1MRGl2RWxlbWVudCA9IGNyZWF0ZURpdihcclxuICAgICAgICBcInNldHRpbmdzLXNlYXJjaC1jb250YWluZXIgdmVydGljYWwtdGFiLWhlYWRlci1ncm91cFwiXHJcbiAgICApO1xyXG4gICAgc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwgPSBjcmVhdGVEaXYoXHJcbiAgICAgICAgXCJzZXR0aW5ncy1zZWFyY2gtcmVzdWx0cy1jb250YWluZXIgdmVydGljYWwtdGFiLWNvbnRlbnRcIlxyXG4gICAgKTtcclxuICAgIHNldHRpbmdzTmF2SXRlbUNvbnRhaW5lciA9IHRoaXMuc2V0dGluZ3NTZWFyY2hFbFxyXG4gICAgICAgIC5jcmVhdGVEaXYoXCJ2ZXJ0aWNhbC10YWItaGVhZGVyLWdyb3VwLWl0ZW1zXCIpXHJcbiAgICAgICAgLmNyZWF0ZURpdihcInZlcnRpY2FsLXRhYi1uYXYtaXRlbSBzZXR0aW5ncy1zZWFyY2gtaW5wdXRcIik7XHJcbiAgICBzZXR0aW5nc1Jlc3VsdHNFbDogSFRNTERpdkVsZW1lbnQ7XHJcbiAgICBzZWFyY2g6IFNlYXJjaENvbXBvbmVudDtcclxuICAgIGxvY2FsZTogc3RyaW5nO1xyXG5cclxuICAgIHJlc291cmNlczogUmVzb3VyY2VbXSA9IFtdO1xyXG4gICAgcmVzdWx0czogUmVzb3VyY2VbXSA9IFtdO1xyXG5cclxuICAgIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeShhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzQ29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBcIlNldHRpbmdzIFNlYXJjaCBSZXN1bHRzXCJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwgPSB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsLmNyZWF0ZURpdihcclxuICAgICAgICAgICAgICAgIFwic2V0dGluZ3Mtc2VhcmNoLXJlc3VsdHNcIlxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5idWlsZFNjb3BlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYnVpbGRTZWFyY2goKTtcclxuICAgICAgICAgICAgdGhpcy5idWlsZFJlc291cmNlcygpO1xyXG4gICAgICAgICAgICB0aGlzLmJ1aWxkUGx1Z2luUmVzb3VyY2VzKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGF0Y2hTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdGFiSW5kZXggPSAwO1xyXG4gICAgcGx1Z2luVGFiSW5kZXggPSAwO1xyXG4gICAgYnVpbGRSZXNvdXJjZXMoKSB7XHJcbiAgICAgICAgY29uc3QgdGFiID0gdGhpcy5hcHAuc2V0dGluZy5zZXR0aW5nVGFic1t0aGlzLnRhYkluZGV4XTtcclxuICAgICAgICBpZiAodGFiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFiUmVzb3VyY2VzKHRhYik7XHJcbiAgICAgICAgICAgIHRoaXMudGFiSW5kZXgrKztcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmJ1aWxkUmVzb3VyY2VzKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGJ1aWxkUGx1Z2luUmVzb3VyY2VzKCkge1xyXG4gICAgICAgIGNvbnN0IHRhYiA9IHRoaXMuYXBwLnNldHRpbmcucGx1Z2luVGFic1t0aGlzLnBsdWdpblRhYkluZGV4XTtcclxuICAgICAgICBpZiAodGFiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0VGFiUmVzb3VyY2VzKHRhYik7XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luVGFiSW5kZXgrKztcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLmJ1aWxkUGx1Z2luUmVzb3VyY2VzKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldCBtYW5pZmVzdHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXModGhpcy5hcHAucGx1Z2lucy5tYW5pZmVzdHMpO1xyXG4gICAgfVxyXG4gICAgc2V0dGluZ0NhY2hlOiBNYXA8c3RyaW5nLCBTZXR0aW5nPiA9IG5ldyBNYXAoKTtcclxuICAgIGFkZFJlc291cmNlVG9DYWNoZShyZXNvdXJjZTogUmVzb3VyY2UpIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY3JlYXRlRGl2KCkpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKHJlc291cmNlLnRleHQpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKFxyXG4gICAgICAgICAgICAgICAgY3JlYXRlRnJhZ21lbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgKGUpID0+IChlLmNyZWF0ZURpdigpLmlubmVySFRNTCA9IHJlc291cmNlLmRlc2MgPz8gXCJcIilcclxuICAgICAgICAgICAgICAgIClcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKHJlc291cmNlLnRhYiA9PSBcImNvbW11bml0eS1wbHVnaW5zXCIpIHtcclxuICAgICAgICAgICAgbGV0IHBsdWdpbiA9IHRoaXMubWFuaWZlc3RzLmZpbmQoKHApID0+IHAubmFtZSA9PSByZXNvdXJjZS50ZXh0KTtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICAgcGx1Z2luICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5wbHVnaW5zLmdldFBsdWdpbihwbHVnaW4uaWQpPy5fbG9hZGVkICYmXHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnBsdWdpblRhYnMuZmluZCgodCkgPT4gdC5pZCA9PSBwbHVnaW4uaWQpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgc2V0dGluZy5hZGRFeHRyYUJ1dHRvbigoYikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGIuc2V0VG9vbHRpcChgT3BlbiAke3Jlc291cmNlLnRleHR9IFNldHRpbmdzYCkub25DbGljayhcclxuICAgICAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZChwbHVnaW4uaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXNvdXJjZS50YWIgPT0gXCJwbHVnaW5zXCIpIHtcclxuICAgICAgICAgICAgY29uc3QgcGx1Z2lucyA9IE9iamVjdC52YWx1ZXModGhpcy5hcHAuaW50ZXJuYWxQbHVnaW5zLnBsdWdpbnMpO1xyXG4gICAgICAgICAgICBjb25zdCBwbHVnaW4gPSBwbHVnaW5zLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAocCkgPT4gcC5fbG9hZGVkICYmIHAuaW5zdGFuY2UubmFtZSA9PSByZXNvdXJjZS50ZXh0XHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgICBwbHVnaW4gJiZcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcucGx1Z2luVGFicy5maW5kKFxyXG4gICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LmlkID09IHBsdWdpbi5pbnN0YW5jZS5pZFxyXG4gICAgICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgIHNldHRpbmcuYWRkRXh0cmFCdXR0b24oKGIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBiLnNldFRvb2x0aXAoYE9wZW4gJHtyZXNvdXJjZS50ZXh0fSBTZXR0aW5nc2ApLm9uQ2xpY2soXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQocGx1Z2luLmluc3RhbmNlLmlkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBzZXR0aW5nLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB7XHJcbiAgICAgICAgICAgIGIuc2V0SWNvbihcImZvcndhcmQtYXJyb3dcIikub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dSZXN1bHQocmVzb3VyY2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnNldHRpbmdDYWNoZS5zZXQocmVzb3VyY2UudGV4dCwgc2V0dGluZyk7XHJcbiAgICB9XHJcbiAgICBnZXRSZXNvdXJjZUZyb21DYWNoZShyZXNvdXJjZTogUmVzb3VyY2UpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ0NhY2hlLmhhcyhyZXNvdXJjZS50ZXh0KSkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZFJlc291cmNlVG9DYWNoZShyZXNvdXJjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdDYWNoZS5nZXQocmVzb3VyY2UudGV4dCk7XHJcbiAgICB9XHJcbiAgICByZW1vdmVSZXNvdXJjZXNGcm9tQ2FjaGUocmVzb3VyY2VzOiBSZXNvdXJjZVtdKSB7XHJcbiAgICAgICAgZm9yIChjb25zdCByZXNvdXJjZSBvZiByZXNvdXJjZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5nQ2FjaGUuZGVsZXRlKHJlc291cmNlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIGdldFRhYlJlc291cmNlcyh0YWI6IFNldHRpbmdUYWIpIHtcclxuICAgICAgICBhd2FpdCB0YWIuZGlzcGxheSgpO1xyXG5cclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRhYi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxEaXZFbGVtZW50PihcclxuICAgICAgICAgICAgXCIuc2V0dGluZy1pdGVtOm5vdCguc2V0dGluZy1pdGVtLWhlYWRlcilcIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZm9yIChjb25zdCBlbCBvZiBBcnJheS5mcm9tKHNldHRpbmdzKSkge1xyXG4gICAgICAgICAgICBjb25zdCB0ZXh0ID1cclxuICAgICAgICAgICAgICAgIGVsLnF1ZXJ5U2VsZWN0b3I8SFRNTERpdkVsZW1lbnQ+KFxyXG4gICAgICAgICAgICAgICAgICAgIFwiLnNldHRpbmctaXRlbS1uYW1lXCJcclxuICAgICAgICAgICAgICAgICk/LnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICBpZiAoIXRleHQpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVzYyA9XHJcbiAgICAgICAgICAgICAgICBlbC5xdWVyeVNlbGVjdG9yPEhUTUxEaXZFbGVtZW50PihcIi5zZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb25cIilcclxuICAgICAgICAgICAgICAgICAgICA/LmlubmVySFRNTCA/PyBcIlwiO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcmVzb3VyY2UgPSB7XHJcbiAgICAgICAgICAgICAgICB0YWI6IHRhYi5pZCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IHRhYi5uYW1lLFxyXG4gICAgICAgICAgICAgICAgdGV4dCxcclxuICAgICAgICAgICAgICAgIGRlc2NcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucmVzb3VyY2VzLnB1c2gocmVzb3VyY2UpO1xyXG4gICAgICAgICAgICB0aGlzLmFkZFJlc291cmNlVG9DYWNoZShyZXNvdXJjZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmFwcC5zZXR0aW5nLmFjdGl2ZVRhYj8uaWQgPT0gdGFiLmlkKSByZXR1cm47XHJcbiAgICAgICAgdGFiLmNvbnRhaW5lckVsLmRldGFjaCgpO1xyXG4gICAgICAgIHRhYi5oaWRlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcGF0Y2hTZXR0aW5ncygpIHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcihcclxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcclxuICAgICAgICAgICAgICAgIG9uT3BlbjogZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0LmFwcGx5KHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSBzZWxmLnNlYXJjaC5pbnB1dEVsLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy9QYXRjaCBhZGRTZXR0aW5nVGFiIHRvIGNhcHR1cmUgY2hhbmdlcyB0byBwbHVnaW4gc2V0dGluZ3MuXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcihcclxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcclxuICAgICAgICAgICAgICAgIGFkZFNldHRpbmdUYWI6IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YWI6IFNldHRpbmdUYWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5nZXRUYWJSZXNvdXJjZXModGFiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5leHQuY2FsbCh0aGlzLCB0YWIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy9QYXRjaCByZW1vdmVTZXR0aW5nVGFiIHRvIGNhcHR1cmUgY2hhbmdlcyB0byBwbHVnaW4gc2V0dGluZ3MuXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlcihcclxuICAgICAgICAgICAgYXJvdW5kKHRoaXMuYXBwLnNldHRpbmcsIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVNldHRpbmdUYWI6IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0YWI6IFNldHRpbmdUYWIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQbHVnaW5TZXR0aW5nVGFiKHRhYikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlbW92aW5nID0gc2VsZi5yZXNvdXJjZXMuZmlsdGVyKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0KSA9PiB0LnRhYiA9PSB0YWIuaWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnJlc291cmNlcyA9IHNlbGYucmVzb3VyY2VzLmZpbHRlcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodCkgPT4gdC50YWIgIT0gdGFiLmlkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZW1vdmVSZXNvdXJjZXNGcm9tQ2FjaGUocmVtb3ZpbmcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0LmNhbGwodGhpcywgdGFiKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXIoXHJcbiAgICAgICAgICAgIGFyb3VuZCh0aGlzLmFwcC5zZXR0aW5nLCB7XHJcbiAgICAgICAgICAgICAgICBvcGVuVGFiOiBmdW5jdGlvbiAobmV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAodGFiOiBTZXR0aW5nVGFiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoQXBwZW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcHAua2V5bWFwLnBvcFNjb3BlKHNlbGYuc2NvcGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMsIHRhYik7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvcGVuVGFiQnlJZDogZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHRhYjogc3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoQXBwZW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcHAua2V5bWFwLnBvcFNjb3BlKHNlbGYuc2NvcGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMsIHRhYik7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvbkNsb3NlOiBmdW5jdGlvbiAobmV4dCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChQbGF0Zm9ybS5pc01vYmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dC5jYWxsKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBidWlsZFNlYXJjaCgpIHtcclxuICAgICAgICBjb25zdCB0ZW1wU2V0dGluZyA9IG5ldyBTZXR0aW5nKGNyZWF0ZURpdigpKS5hZGRTZWFyY2goKHMpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSBzO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNldHRpbmdzTmF2SXRlbUNvbnRhaW5lci5hcHBlbmQodGVtcFNldHRpbmcuY29udHJvbEVsKTtcclxuXHJcbiAgICAgICAgdGVtcFNldHRpbmcuc2V0dGluZ0VsLmRldGFjaCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNlYXJjaC5vbkNoYW5nZSgodikgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9uQ2hhbmdlKHYpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoLnNldFBsYWNlaG9sZGVyKFwiU2VhcmNoIHNldHRpbmdzLi4uXCIpO1xyXG4gICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiSGVhZGVyc0VsLnByZXBlbmQodGhpcy5zZXR0aW5nc1NlYXJjaEVsKTtcclxuICAgIH1cclxuXHJcbiAgICBzZWFyY2hBcHBlbmRlZCA9IGZhbHNlO1xyXG4gICAgYWN0aXZlSW5kZXggPSAtMTtcclxuICAgIGFjdGl2ZVNldHRpbmc6IFNldHRpbmc7XHJcbiAgICBzY29wZSA9IG5ldyBTY29wZSh0aGlzLmFwcC5zY29wZSk7XHJcbiAgICBidWlsZFNjb3BlKCkge1xyXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dEb3duXCIsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlU2V0dGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nLnNldHRpbmdFbC5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID1cclxuICAgICAgICAgICAgICAgICgoKHRoaXMuYWN0aXZlSW5kZXggKyAxKSAlIHRoaXMucmVzdWx0cy5sZW5ndGgpICtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoKSAlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jZW50ZXJBY3RpdmVTZXR0aW5nKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJBcnJvd1VwXCIsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlU2V0dGluZykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nLnNldHRpbmdFbC5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID1cclxuICAgICAgICAgICAgICAgICgoKHRoaXMuYWN0aXZlSW5kZXggLSAxKSAlIHRoaXMucmVzdWx0cy5sZW5ndGgpICtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoKSAlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdHMubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jZW50ZXJBY3RpdmVTZXR0aW5nKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVNldHRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1Jlc3VsdCh0aGlzLnJlc3VsdHNbdGhpcy5hY3RpdmVJbmRleF0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY2VudGVyQWN0aXZlU2V0dGluZygpIHtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc3VsdHNbdGhpcy5hY3RpdmVJbmRleF07XHJcbiAgICAgICAgdGhpcy5hY3RpdmVTZXR0aW5nID0gdGhpcy5nZXRSZXNvdXJjZUZyb21DYWNoZShyZXN1bHQpO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZy5zZXR0aW5nRWwuc2Nyb2xsSW50b1ZpZXcoe1xyXG4gICAgICAgICAgICBiZWhhdmlvcjogXCJhdXRvXCIsXHJcbiAgICAgICAgICAgIGJsb2NrOiBcIm5lYXJlc3RcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgbW9iaWxlQ29udGFpbmVyczogSFRNTEVsZW1lbnRbXSA9IFtdO1xyXG4gICAgZGV0YWNoRnJvbU1vYmlsZSgpIHtcclxuICAgICAgICBpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNDb250YWluZXJFbC5kZXRhY2goKTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgdGhpcy5tb2JpbGVDb250YWluZXJzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLnRhYkhlYWRlcnNFbC5hcHBlbmQoaGVhZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLnNlYXJjaC5zZXRWYWx1ZShcIlwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBkZXRhY2hGcm9tRGVza3RvcCgpIHtcclxuICAgICAgICBpZiAoUGxhdGZvcm0uaXNEZXNrdG9wKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcub3BlblRhYkJ5SWQodGhpcy5hcHAuc2V0dGluZy5sYXN0VGFiSWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGRldGFjaCgpIHtcclxuICAgICAgICB0aGlzLmRldGFjaEZyb21EZXNrdG9wKCk7XHJcbiAgICAgICAgdGhpcy5kZXRhY2hGcm9tTW9iaWxlKCk7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hBcHBlbmRlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgb25DaGFuZ2Uodjogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKCF2KSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuc2VhcmNoQXBwZW5kZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmVJbmRleCA9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLmFwcC5rZXltYXAucG9wU2NvcGUodGhpcy5zY29wZSk7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLmtleW1hcC5wdXNoU2NvcGUodGhpcy5zY29wZSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmFjdGl2ZVNldHRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlU2V0dGluZy5zZXR0aW5nRWwucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGl2ZVNldHRpbmcgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLmFjdGl2ZVRhYi5uYXZFbC5yZW1vdmVDbGFzcyhcImlzLWFjdGl2ZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiQ29udGVudENvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJDb250ZW50Q29udGFpbmVyLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy50YWJIZWFkZXJzRWwucXVlcnlTZWxlY3RvckFsbDxIVE1MRWxlbWVudD4oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiLnZlcnRpY2FsLXRhYi1oZWFkZXItZ3JvdXA6bm90KC5zZXR0aW5ncy1zZWFyY2gtY29udGFpbmVyKVwiXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaGVhZGVyIG9mIEFycmF5LmZyb20oaGVhZGVycykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm1vYmlsZUNvbnRhaW5lcnMucHVzaChoZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5kZXRhY2goKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcudGFiSGVhZGVyc0VsLmFwcGVuZChcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzUmVzdWx0c0NvbnRhaW5lckVsXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoQXBwZW5kZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFwcGVuZFJlc3VsdHModGhpcy5wZXJmb3JtRnV6enlTZWFyY2godikpO1xyXG4gICAgfVxyXG4gICAgZ2V0TWF0Y2hUZXh0KHRleHQ6IHN0cmluZywgcmVzdWx0OiBTZWFyY2hSZXN1bHQpIHtcclxuICAgICAgICBjb25zdCBtYXRjaEVsZW1lbnRzOiBSZWNvcmQ8bnVtYmVyLCBIVE1MRWxlbWVudD4gPSB7fTtcclxuICAgICAgICByZXR1cm4gY3JlYXRlRnJhZ21lbnQoKGNvbnRlbnQpID0+IHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSByZXN1bHQubWF0Y2hlcy5maW5kKChtKSA9PiBtWzBdID09PSBpKTtcclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcmVzdWx0Lm1hdGNoZXMuaW5kZXhPZihtYXRjaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXRjaEVsZW1lbnRzW2luZGV4XSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEVsZW1lbnRzW2luZGV4XSA9IGNyZWF0ZVNwYW4oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInN1Z2dlc3Rpb24taGlnaGxpZ2h0XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSBtYXRjaEVsZW1lbnRzW2luZGV4XTtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kVGV4dCh0ZXh0LnN1YnN0cmluZyhtYXRjaFswXSwgbWF0Y2hbMV0pKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaSArPSBtYXRjaFsxXSAtIG1hdGNoWzBdIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb250ZW50LmFwcGVuZFRleHQodGV4dFtpXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFwcGVuZFJlc3VsdHMocmVzdWx0czogUmVzb3VyY2VbXSkge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuZW1wdHkoKTtcclxuICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgY29uc3QgaGVhZGVyczogUmVjb3JkPHN0cmluZywgSFRNTEVsZW1lbnQ+ID0ge307XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgcmVzdWx0cykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEocmVzb3VyY2UudGFiIGluIGhlYWRlcnMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLyogaWYgKHJlc291cmNlLnRhYiA9PSBcImhvdGtleXNcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzW3Jlc291cmNlLnRhYl0gPSBjcmVhdGVEaXYoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyAqL1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbcmVzb3VyY2UudGFiXSA9IHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuY3JlYXRlRGl2KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLyogfSAqL1xyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBTZXR0aW5nKGhlYWRlcnNbcmVzb3VyY2UudGFiXSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEhlYWRpbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0TmFtZShyZXNvdXJjZS5uYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZXR0aW5nID0gdGhpcy5nZXRSZXNvdXJjZUZyb21DYWNoZShyZXNvdXJjZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaGVhZGVyc1tyZXNvdXJjZS50YWJdLmFwcGVuZChzZXR0aW5nLnNldHRpbmdFbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLyogaWYgKFwiaG90a2V5c1wiIGluIGhlYWRlcnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3NSZXN1bHRzRWwuYXBwZW5kQ2hpbGQoaGVhZGVyc1tcImhvdGtleXNcIl0pO1xyXG4gICAgICAgICAgICB9ICovXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbC5zZXRUZXh0KFwiTm8gcmVzdWx0cyBmb3VuZCA6KFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2hvd1Jlc3VsdChyZXN1bHQ6IFJlc291cmNlKSB7XHJcbiAgICAgICAgdGhpcy5zZWFyY2guc2V0VmFsdWUoXCJcIik7XHJcbiAgICAgICAgY29uc3QgdGFiID1cclxuICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5zZXR0aW5nVGFicy5maW5kKCh0KSA9PiB0LmlkID09IHJlc3VsdC50YWIpID8/XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnNldHRpbmcucGx1Z2luVGFicy5maW5kKCh0KSA9PiB0LmlkID09IHJlc3VsdC50YWIpO1xyXG4gICAgICAgIGlmICghdGFiKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJUaGVyZSB3YXMgYW4gaXNzdWUgb3BlbmluZyB0aGUgc2V0dGluZyB0YWIuXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmFwcC5zZXR0aW5nLm9wZW5UYWJCeUlkKHRhYi5pZCk7XHJcbiAgICAgICAgdGhpcy5hcHAua2V5bWFwLnBvcFNjb3BlKHRoaXMuc2NvcGUpO1xyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5kZXRhY2goKSk7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVzID1cclxuICAgICAgICAgICAgICAgIHRhYi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNldHRpbmctaXRlbS1uYW1lXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBlbCA9IEFycmF5LmZyb20obmFtZXMpLmZpbmQoXHJcbiAgICAgICAgICAgICAgICAobikgPT4gbi50ZXh0Q29udGVudCA9PSByZXN1bHQudGV4dFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoIWVsKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzZXR0aW5nID0gZWwuY2xvc2VzdChcIi5zZXR0aW5nLWl0ZW1cIik7XHJcbiAgICAgICAgICAgIGlmICghc2V0dGluZykgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRhYi5pZCA9PSBcIm9ic2lkaWFuLXN0eWxlLXNldHRpbmdzXCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjb2xsYXBzZWQgPSBzZXR0aW5nLmNsb3Nlc3QoXCIuc3R5bGUtc2V0dGluZ3MtY29udGFpbmVyXCIpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHByZXZpb3VzID0gY29sbGFwc2VkPy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xyXG5cclxuICAgICAgICAgICAgICAgIHdoaWxlIChcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91cyAhPSBudWxsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMuaGFzQ2xhc3MoXCJpcy1jb2xsYXBzZWRcIikgJiZcclxuICAgICAgICAgICAgICAgICAgICBwcmV2aW91cy5oYXNDbGFzcyhcInN0eWxlLXNldHRpbmdzLWhlYWRpbmdcIilcclxuICAgICAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgICAgICAgIHByZXZpb3VzLnJlbW92ZUNsYXNzKFwiaXMtY29sbGFwc2VkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbGxhcHNlZCA9IGNvbGxhcHNlZC5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcIi5zdHlsZS1zZXR0aW5ncy1jb250YWluZXJcIlxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgcHJldmlvdXMgPSBjb2xsYXBzZWQ/LnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBkZXRhaWxzID0gc2V0dGluZy5jbG9zZXN0KFwiZGV0YWlsc1wiKTtcclxuICAgICAgICAgICAgd2hpbGUgKGRldGFpbHMpIHtcclxuICAgICAgICAgICAgICAgIGRldGFpbHMuc2V0QXR0cihcIm9wZW5cIiwgXCJvcGVuXCIpO1xyXG4gICAgICAgICAgICAgICAgZGV0YWlscyA9IGRldGFpbHMucGFyZW50RWxlbWVudD8uY2xvc2VzdChcImRldGFpbHNcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNldHRpbmcuc2Nyb2xsSW50b1ZpZXcodHJ1ZSk7XHJcblxyXG4gICAgICAgICAgICBzZXR0aW5nLmFkZENsYXNzKFwiaXMtZmxhc2hpbmdcIik7XHJcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJJbnRlcnZhbChcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KFxyXG4gICAgICAgICAgICAgICAgICAgICgpID0+IHNldHRpbmcucmVtb3ZlQ2xhc3MoXCJpcy1mbGFzaGluZ1wiKSxcclxuICAgICAgICAgICAgICAgICAgICAzMDAwXHJcbiAgICAgICAgICAgICAgICApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwZXJmb3JtRnV6enlTZWFyY2goaW5wdXQ6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHM6IFJlc291cmNlW10gPSBbXSxcclxuICAgICAgICAgICAgaG90a2V5czogUmVzb3VyY2VbXSA9IFtdO1xyXG4gICAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgdGhpcy5yZXNvdXJjZXMpIHtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9XHJcbiAgICAgICAgICAgICAgICBwcmVwYXJlU2ltcGxlU2VhcmNoKGlucHV0KShyZXNvdXJjZS50ZXh0KSA/P1xyXG4gICAgICAgICAgICAgICAgcHJlcGFyZVNpbXBsZVNlYXJjaChpbnB1dCkocmVzb3VyY2UuZGVzYyk7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZS50YWIgPT0gXCJob3RrZXlzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBob3RrZXlzLnB1c2gocmVzb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLnB1c2gocmVzb3VyY2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVzdWx0cyA9IFsuLi5yZXN1bHRzLCAuLi5ob3RrZXlzXTtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRzO1xyXG4gICAgfVxyXG5cclxuICAgIG9udW5sb2FkKCkge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3NTZWFyY2hFbC5kZXRhY2goKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXR0aW5nc1Jlc3VsdHNFbC5kZXRhY2goKTtcclxuICAgICAgICB0aGlzLmRldGFjaCgpO1xyXG4gICAgICAgIGlmICh0aGlzLnNlYXJjaEFwcGVuZGVkICYmIFBsYXRmb3JtLmlzRGVza3RvcClcclxuICAgICAgICAgICAgdGhpcy5hcHAuc2V0dGluZy5vcGVuVGFiQnlJZCh0aGlzLmFwcC5zZXR0aW5nLmxhc3RUYWJJZCk7XHJcbiAgICB9XHJcbn1cclxuIiwgImV4cG9ydCBmdW5jdGlvbiBhcm91bmQob2JqLCBmYWN0b3JpZXMpIHtcbiAgICBjb25zdCByZW1vdmVycyA9IE9iamVjdC5rZXlzKGZhY3RvcmllcykubWFwKGtleSA9PiBhcm91bmQxKG9iaiwga2V5LCBmYWN0b3JpZXNba2V5XSkpO1xuICAgIHJldHVybiByZW1vdmVycy5sZW5ndGggPT09IDEgPyByZW1vdmVyc1swXSA6IGZ1bmN0aW9uICgpIHsgcmVtb3ZlcnMuZm9yRWFjaChyID0+IHIoKSk7IH07XG59XG5mdW5jdGlvbiBhcm91bmQxKG9iaiwgbWV0aG9kLCBjcmVhdGVXcmFwcGVyKSB7XG4gICAgY29uc3Qgb3JpZ2luYWwgPSBvYmpbbWV0aG9kXSwgaGFkT3duID0gb2JqLmhhc093blByb3BlcnR5KG1ldGhvZCk7XG4gICAgbGV0IGN1cnJlbnQgPSBjcmVhdGVXcmFwcGVyKG9yaWdpbmFsKTtcbiAgICAvLyBMZXQgb3VyIHdyYXBwZXIgaW5oZXJpdCBzdGF0aWMgcHJvcHMgZnJvbSB0aGUgd3JhcHBpbmcgbWV0aG9kLFxuICAgIC8vIGFuZCB0aGUgd3JhcHBpbmcgbWV0aG9kLCBwcm9wcyBmcm9tIHRoZSBvcmlnaW5hbCBtZXRob2RcbiAgICBpZiAob3JpZ2luYWwpXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihjdXJyZW50LCBvcmlnaW5hbCk7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIGN1cnJlbnQpO1xuICAgIG9ialttZXRob2RdID0gd3JhcHBlcjtcbiAgICAvLyBSZXR1cm4gYSBjYWxsYmFjayB0byBhbGxvdyBzYWZlIHJlbW92YWxcbiAgICByZXR1cm4gcmVtb3ZlO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIGJlZW4gZGVhY3RpdmF0ZWQgYW5kIGFyZSBubyBsb25nZXIgd3JhcHBlZCwgcmVtb3ZlIG91cnNlbHZlc1xuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwgJiYgb2JqW21ldGhvZF0gPT09IHdyYXBwZXIpXG4gICAgICAgICAgICByZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgLy8gSWYgbm8gb3RoZXIgcGF0Y2hlcywganVzdCBkbyBhIGRpcmVjdCByZW1vdmFsXG4gICAgICAgIGlmIChvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcikge1xuICAgICAgICAgICAgaWYgKGhhZE93bilcbiAgICAgICAgICAgICAgICBvYmpbbWV0aG9kXSA9IG9yaWdpbmFsO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBvYmpbbWV0aG9kXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIEVsc2UgcGFzcyBmdXR1cmUgY2FsbHMgdGhyb3VnaCwgYW5kIHJlbW92ZSB3cmFwcGVyIGZyb20gdGhlIHByb3RvdHlwZSBjaGFpblxuICAgICAgICBjdXJyZW50ID0gb3JpZ2luYWw7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih3cmFwcGVyLCBvcmlnaW5hbCB8fCBGdW5jdGlvbik7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGRlZHVwZShrZXksIG9sZEZuLCBuZXdGbikge1xuICAgIGNoZWNrW2tleV0gPSBrZXk7XG4gICAgcmV0dXJuIGNoZWNrO1xuICAgIGZ1bmN0aW9uIGNoZWNrKC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIChvbGRGbltrZXldID09PSBrZXkgPyBvbGRGbiA6IG5ld0ZuKS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYWZ0ZXIocHJvbWlzZSwgY2IpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGNiLCBjYik7XG59XG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplKGFzeW5jRnVuY3Rpb24pIHtcbiAgICBsZXQgbGFzdFJ1biA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbGFzdFJ1biA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAgICAgYWZ0ZXIobGFzdFJ1biwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzeW5jRnVuY3Rpb24uYXBwbHkodGhpcywgYXJncykudGhlbihyZXMsIHJlaik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHdyYXBwZXIuYWZ0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7IGFmdGVyKGxhc3RSdW4sIHJlcyk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIHdyYXBwZXI7XG59XG4iXSwKICAibWFwcGluZ3MiOiAi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
